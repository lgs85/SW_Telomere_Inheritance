---
output:
  word_document:
    reference_docx: myrefsinglespace.docx
---



```{r setup, include = F}

rm(list=ls())

#Load knitr
library(knitr)

#Set some options
options(na.action='na.fail')
opts_knit$set(root.dir = '..')
opts_chunk$set(echo=FALSE,
               warning=FALSE,
               message=FALSE,
               fig.path='../Figures/',
               fig.width= 8,
               fig.height= 8,
               fig.show='asis',
               dev='png')

```

```{r load and clean, include = F}

#Load and clean data
source('Scripts/Telomere parentage LOAD.r')
source('Scripts/Telomere parentage FUNCTIONS.r')
source('Scripts/Telomere parentage CLEAN.r')
source('Scripts/Telomere parentage MODELS.r')


```




**Table S1** Generalised linear mixed model output for analysis of parental telomere length offspring sex ratio. We ran seperate models for mothers, fathers, and the mean telomere length of both parents.

```{r Table S1}

Mothers <- rep(' ',4)
  
mumtab <- summary(sr_FLmumTL)$coefficients
mumtab <- rbind(mumtab,summary(sr_FLmumTQ)$coefficients['TQ',,drop=FALSE])
mumtab <- rbind(mumtab,summary(sr_FLmumTQ)$coefficients['TQ',,drop=FALSE])
mumtab <- round(mumtab,3)


Fathers <- rep(' ',4)

dadtab <- summary(sr_FLdadTL)$coefficients
dadtab <- rbind(dadtab,summary(sr_FLdadTQ)$coefficients[c('TQ','dadage'),])
dadtab <- round(dadtab,3)

Combined <- rep(' ',4)

partab <- summary(sr_FLparTL)$coefficients
partab <- rbind(partab,summary(sr_FLparTQ)$coefficients['TQ',,drop = FALSE])
partab <- round(partab,3)

TableS1 <- rbind(Mothers,mumtab,Fathers,dadtab,Combined,partab)
TableS1[TableS1 == '0'] <- '<0.001'

nams <- rownames(TableS1)
nams[nams == 'LmumTLKB'] <- 'Maternal TL'
nams[nams == 'mumage'] <- 'Maternal age'
nams[nams == 'Helper'] <- 'Num. Helpers'
nams[nams == 'LdadTLKB'] <- 'Paternal TL'
nams[nams == 'dadage'] <- 'Paternal age'
nams[nams == 'parTL'] <- 'Parental TL'

rownames(TableS1) <- nams
colnames(TableS1)[colnames(TableS1) == "Pr(>|z|)"] <- "P"

kable(TableS1)

```


PAGEBREAK

**Table S2** Linear mixed model output showing the relaitonship between parental and offspring telomere length in the Seyhelles warbler. We ran seperate models mor mothers, fathers, and the mean telomere length of both parents.


```{r Table S2}

Mothers <- rep(' ',4)
  
mumtab <- summary(FLTL_LmumTL)$coefficients
P <- 2 * (1 - pnorm(abs(mumtab[,'t value'])))
mumtab <- cbind(mumtab,P)
mumtab <- round(mumtab,3)


Fathers <- rep(' ',4)

dadtab <- summary(FLTL_LdadTL)$coefficients
P <- 2 * (1 - pnorm(abs(dadtab[,'t value'])))
dadtab <- cbind(dadtab,P)
dadtab <- round(dadtab,3)

Combined <- rep(' ',4)

partab <- summary(FLTL_parTL)$coefficients
P <- 2 * (1 - pnorm(abs(partab[,'t value'])))
partab <- cbind(partab,P)
partab <- round(partab,3)

TableS2 <- rbind(Mothers,mumtab,Fathers,dadtab,Combined,partab)
TableS2[TableS2 == '0'] <- '<0.001'

nams <- rownames(TableS2)
nams[nams == 'LmumTLKB'] <- 'Maternal TL'
nams[nams == 'mumage'] <- 'Maternal age'
nams[nams == 'Helper'] <- 'Num. Helpers'
nams[nams == 'LdadTLKB'] <- 'Paternal TL'
nams[nams == 'dadage'] <- 'Paternal age'
nams[nams == 'parTL'] <- 'Parental TL'
nams[nams == 'SexMales'] <- 'Sex'
nams[nams == 'LmumTLKB:SexMales'] <- 'Maternal TL x Sex'
nams[nams == 'LdadTLKB:SexMales'] <- 'Paternal TL x Sex'
nams[nams == 'parTL:SexMales'] <- 'Parental TL x Sex'

rownames(TableS2) <- nams


kable(TableS2)

```


PAGEBREAK

**Table S3** Generalised linear mixed model output showing the effects of telomere length and sex on survival to adulthood in juvneile Seychelles warblers.

```{r Table S3}


TableS3 <- summary(FLsurv)$coefficients
TableS3 <- round(TableS3,3)
TableS3[TableS3 == '0'] <- '<0.001'

nams <- rownames(TableS3)
nams[nams == 'TLKB'] <- 'TL'
nams[nams == 'SexMales'] <- 'Sex'
nams[nams == 'TLKB:SexMales'] <- 'TL x Sex'

rownames(TableS3) <- nams
colnames(TableS3)[colnames(TableS3) == "Pr(>|z|)"] <- "P"

kable(TableS3)

```



**Table S4** Generalised linear mixed model output for analysis of parental condition on offspring sex ratio. We ran seperate models for mothers, fathers, and the mean body condition of both parents.

```{r Table S4}

Mothers <- rep(' ',4)
  
mumtab <- summary(sr_FLmumcon)$coefficients
mumtab <- round(mumtab,3)


Fathers <- rep(' ',4)

dadtab <- summary(sr_FLdadcon)$coefficients
dadtab <- round(dadtab,3)

Combined <- rep(' ',4)

partab <- summary(sr_FLparcon)$coefficients
partab <- round(partab,3)

TableS4 <- rbind(Mothers,mumtab,Fathers,dadtab,Combined,partab)
TableS4[TableS4 == '0'] <- '<0.001'

nams <- rownames(TableS4)
nams[nams == 'mumcon'] <- 'Maternal condition'
nams[nams == 'mumage'] <- 'Maternal age'
nams[nams == 'Helper'] <- 'Num. Helpers'
nams[nams == 'dadcon'] <- 'Paternal condition'
nams[nams == 'dadage'] <- 'Paternal age'
nams[nams == 'parcon'] <- 'Parental condition'

rownames(TableS4) <- nams
colnames(TableS4)[colnames(TableS4) == "Pr(>|z|)"] <- "P"

kable(TableS4)

```




**Figure S1** Parental body condition in relation to sex ratio in the Seychelles warbler. **A** Maternal and peternal body condition are not related to one another. **B-D** Offspring sex ratio in relation to maternal (**B**), paternal (**C**) and mean parental body condition (**D**). Individual points represent individual male (top) and female (bottom) offspring. Lines and shaded areas represent fitted values and 95% confidence limits from a logistic regression.


```{r FigureS1}

Fig2A <- ggplot(FL,aes(x = dadcon,y = mumcon)) +
  geom_point(alpha=0.2) +
  xlab('Paternal condition') +
  ylab('Maternal condition') +
  theme_lgs(addlegend = T) +
  stat_smooth(method = 'lm') +
  annotate(geom = 'text',x = -1,y = 2,label = 'A')

Fig2B <- ggplot(FL,aes(x = mumcon,y = SexEstimate)) +
  geom_point(alpha=0.2) +
  stat_smooth(method = 'glm',family = 'binomial',se=T) +
  xlab('Maternal condition') +
  ylab('Proportion male offspring') +
  theme_lgs(addlegend = T) +
  annotate(geom = 'text',x = -2,y = 1,label = 'B')

Fig2C <- ggplot(FL,aes(x = dadcon,y = SexEstimate)) +
  geom_point(alpha=0.2) +
  stat_smooth(method = 'glm',family = 'binomial',se=T) +
  xlab('Paternal condition') +
  ylab('Proportion male offspring') +
  theme_lgs(addlegend = T) +
  annotate(geom = 'text',x = -1,y = 1,label = 'C')
Fig2D <- ggplot(FL,aes(x = parcon,y = SexEstimate)) +
  geom_point(alpha=0.2) +
  stat_smooth(method = 'glm',family = 'binomial',se=T) +
  xlab('Mean parental condition') +
  ylab('Proportion male offspring') +
  theme_lgs(addlegend = T) +
  annotate(geom = 'text',x = -1,y = 1,label = 'D')


multiplot(Fig2A,Fig2B,Fig2C,Fig2D,layout=matrix(c(1,2,3,4),2,2,byrow=T))

```
